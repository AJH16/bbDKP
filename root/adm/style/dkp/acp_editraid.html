<!-- INCLUDE overall_header.html -->
<!--
		$Id$
//-->
<a name="maincontent"></a>

<script type="text/javascript">

//<![CDATA[

function check_form()
{
	// checking length of raidmembername
	if (document.addraid.elements["raid_attendees[]"].value.length < 1)
    {
        alert('{MSG_ATTENDEES_EMPTY}');
        return false;
    }
    
    // checking if there is an event selected	
    if (document.addraid.elements["raid_name[]"].value.length < 1)
    {
        alert('{MSG_NAME_EMPTY}');
        return false;
    }
    return true;
}
   
function fnSearch( searchField, searchItem )
{
    var searchBox = document.addraid.elements[searchField];
    var selectBox = document.addraid.elements[searchItem];
   
    var reSearch = new RegExp( searchBox.value, "i" );
   
    var len = selectBox.options.length;
    for ( var i = 0; i < len; i++ )
    {
        if( reSearch.test( selectBox.options[i].value ) )
        {
            selectBox.options[i].selected = true;
            break;
        }
    }
}


function fnAddMember()
{
	
    var form = document.addraid;
    var fromField = form.all_members;
    //destination
    var toField = form.elements["raid_attendees[]"];

    var fromSize = fromField.options.length
    var toSize = toField.options.length

    var aSelected = new Array();

    // Build an array of the selected members
    for (var i = 0; i < fromSize; i++)
    {
        if ( fromField.options[i].selected == true )
        {
            aSelected[aSelected.length] = i;
        }
    }

    var offset = 0;
    for(var i = 0; i < aSelected.length; i++ )
    {
        var index = aSelected[i];

        var memberValue = fromField.options[index].value;
        var memberText = fromField.options[index].text;

        // Remove the initial spacer member
        if ( (toSize == 1) && (toField.options[0].value == "") )
        {
            toSize = 0;
        }

        // Loop through the destination list, don't add if it's a duplicate
        for (var j = 0, exists = false; j < toSize; j++ )
        {
            // destination already exists
            if ( toField.options[ j ].value == memberValue )
            {
                var exists = true;
                offset++;
            }
        }

        // destination doesnt exist, add them
        if ( exists != true )
        {
            toField.options[toSize + i - offset] = new Option(memberText, memberValue);
            toField.options[toSize + i - offset].selected = true;
        }
    }
    
    // done - clear the search box and focus it for the next entry
    form.memberSearch.value = "";
    form.memberSearch.focus();

    //return false;
}

function fnRemoveMember()
{
  var form = document.addraid;
  var toField = form.elements["raid_attendees[]"];
  var toSize = toField.options.length;
    
  var i;
  for (i = toField.length - 1; i>=0; i--) 
  {
  	if (toField.options[i].selected) 
  	  {
     	 toField.remove(i);
  	  }
  }
}

//]]>

</script>

<form method="post" action="{F_ADD_RAID}" name="addraid" onsubmit="return check_form(this)">
<div>

<h1>{RAIDTITLE}</h1>
<p>{L_EXPLAIN}</p>

<div style="float: left; width: 55%;">
<fieldset>

<legend>{L_EDIT_RAID_TITLE}</legend>

<input type="hidden" name="hidden_id" value="{RAID_ID}" /> 
	<dl><dt><label>{L_POOL}:</label></dt>
	<dd><strong>{RAID_DKPPOOL}</strong></dd>
	</dl>
	
	<dl>
		<dt><label>{L_EVENT}:</label></dt>
    <dd>
	    <select name="event_id" id="event_id"" >
			<!-- BEGIN events_row -->
			<option value="{events_row.VALUE}"{events_row.SELECTED}>{events_row.OPTION}</option>
			<!-- END events_row -->
		</select>
	</dd>
	</dl>		
	
	<dl>
		<dt><label>{L_DATE}:</label></dt>
		<dd>
		<select name="d">{S_RAIDDATE_DAY_OPTIONS}</select>
		<select name="mo">{S_RAIDDATE_MONTH_OPTIONS}</select> 
		<select name="Y">{S_RAIDDATE_YEAR_OPTIONS}</select>
			
	   </dd>
	</dl>
	<dl>
		<dt><label>{L_RAIDSTART}:</label></dt>
		<dd>
			<select name="sh">{S_RAIDSTART_H_OPTIONS}</select>
			<select name="smi">{S_RAIDSTART_MI_OPTIONS}</select> 
			<select name="ss">{S_RAIDSTART_S_OPTIONS}</select>
		</dd>
	</dl>
	<dl>
		<dt><label>{L_RAIDEND}:</label></dt>
		<dd>
			<select name="eh">{S_RAIDEND_H_OPTIONS}</select>
			<select name="emi">{S_RAIDEND_MI_OPTIONS}</select> 
			<select name="es">{S_RAIDEND_S_OPTIONS}</select>
		</dd>
	</dl>
		

	<dl>
		<dt><label>{L_RAIDVALUE}:</label>({L_ADD_RAID_VALUE_NOTE})</dt>
		<dd>
			<input type="text" name="raid_value" id="raid_value" size="8" maxlength="7" value="{RAID_VALUE}" class="input" />{FV_VALUE}
		</dd>
	</dl>
		
		
</fieldset>
</div>


<div style="float: left; width: 45%;">
<fieldset>
<legend>{L_NOTE}</legend>
	<textarea name="raid_note" cols="60" rows="12" wrap="soft">{RAID_NOTE}</textarea>
</fieldset>
</div>


<div style="clear: both; width: 100%;">
<fieldset>
<legend>{L_ATTENDEES}</legend>
<table cellspacing="1">
<thead>
  <tr>
    <th style="text-align:left;" width="30%"><a href="{U_LIST_RAIDS}&amp;o={O_NAME}&amp;start={START}">{L_NAME}</a></th>
    <th style="text-align:right;" width="15%" width="30" nowrap="nowrap"><a href="{U_LIST_RAIDS}&amp;o={O_RAIDVALUE}&amp;start={START}">{L_RAIDVALUE}</a></th>
    <th style="text-align:right;" width="15%" width="30" nowrap="nowrap"><a href="{U_LIST_RAIDS}&amp;o={O_TIMEVALUE}&amp;start={START}">{L_TIMEVALUE}</a></th>
    <th style="text-align:right;" width="15%" width="30" nowrap="nowrap"><a href="{U_LIST_RAIDS}&amp;o={O_ZSVALUE}&amp;start={START}">{L_ZSVALUE}</a></th>
    <th style="text-align:right;" width="15%" nowrap="nowrap"><a href="{U_LIST_RAIDS}&amp;o={O_DECAYVALUE}&amp;start={START}">{L_DECAY}</a></th>
    <th style="text-align:right;" width="15%" nowrap="nowrap"><a href="{U_LIST_RAIDS}&amp;o={O_TOTALVALUE}&amp;start={START}">{L_TOTAL}</a></th>
    <th style="text-align:center;" width="5">{L_ACTION}</th>
  </tr>
  </thead>
<tbody>
  <!-- BEGIN raids_row -->
  <!-- IF raids_row.S_ROW_COUNT is even --><tr class="row1"><!-- ELSE --><tr class="row2"><!-- ENDIF -->
    <td style="text-align:left;" width="30%"><a href="{raids_row.U_VIEW_MEMBER}">{raids_row.NAME}</a></td>
    <td style="text-align:right;" width="15%" class="positive">{raids_row.RAIDVALUE}</td>
    <td style="text-align:right;" width="15%" class="positive">{raids_row.TIMEVALUE}</td>
    <td style="text-align:right;" width="15%" class="positive">{raids_row.ZSVALUE}</td>
    <td style="text-align:right;" width="15%" class="negative">{raids_row.DECAYVALUE}</td>
    <td style="text-align:right;" width="15%" class="positive">{raids_row.TOTAL}</td>
    <td style="text-align:center;"  width="5" nowrap="nowrap">
		<a href="{raids_row.U_VIEW_RAID}">{ICON_EDIT}&nbsp;{ICON_DELETE}</a>
	</td>
	
  </tr>
  <!-- END raids_row -->
  <tr>
    <th colspan="8" class="footer">{LISTRAIDS_FOOTCOUNT}</th>
  </tr>
  </tbody>
</table>


</fieldset>
</div>

</div>
{S_FORM_TOKEN}
<!-- IF S_ADD --> 
<fieldset class="quick" style="float: {S_CONTENT_FLOW_END};">
    <input type="submit" name="add"	value="{L_ADD_RAID}" class="button1" /> 
    <input type="reset" name="reset" value="{L_RESET}" class="button1" />
</fieldset> 
<!-- ELSE --> 
<fieldset class="quick" style="float: {S_CONTENT_FLOW_BEGIN};">
	<input type="submit" name="delete" value="{L_DELETE_RAID}"	class="button1" />
</fieldset>
	<fieldset class="quick" style="float: {S_CONTENT_FLOW_END};">
	<input type="submit" name="update" value="{L_UPDATE_RAID}" class="button1" />
	<input type="submit" name="additem" value="{L_ADD_ITEM}" class="button1" />
</fieldset>
<!-- ENDIF -->

</form>


<!-- INCLUDE dkp/overall_footer.html -->
